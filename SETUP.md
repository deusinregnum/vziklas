# üöÄ –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è - –ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?

### ‚ùå –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞
- –ü–∞—Ä—Å–∏–Ω–≥ **–ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—Ç–≤–µ—Ç: **30-60 —Å–µ–∫** ‚è≥
- –ë–æ–ª—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ bazos.sk
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥—ë—Ç

### ‚úÖ –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- –ü–∞—Ä—Å–∏–Ω–≥ **—Ä–∞–∑ –≤ 3 —á–∞—Å–∞** –≤ —Ñ–æ–Ω–µ üîÑ
- –û—Ç–≤–µ—Ç: **< 1 —Å–µ–∫** ‚ö°
- –î–∞–Ω–Ω—ã–µ –≤ **SQLite –ë–î**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
‚îú‚îÄ‚îÄ database.py          ‚Üê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SQLite –ë–î
‚îú‚îÄ‚îÄ rentals.db           ‚Üê –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ ARCHITECTURE.md      ‚Üê –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
‚îú‚îÄ‚îÄ bot.py              ‚Üê –î–æ–±–∞–≤–ª–µ–Ω APScheduler –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ rental_data.py      ‚Üê –¢–µ–ø–µ—Ä—å –ø–∏—à–µ—Ç/—á–∏—Ç–∞–µ—Ç –∏–∑ –ë–î
‚îî‚îÄ‚îÄ requirements.txt    ‚Üê –î–æ–±–∞–≤–ª–µ–Ω apscheduler
```

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
```python
from database import init_db
init_db()  # –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
```

### –ü–∞—Ä—Å–∏–Ω–≥ (—Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞)
```python
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
# 1Ô∏è‚É£ –û–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞
# 2Ô∏è‚É£ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞

await background_parse_rentals()
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```python
# –í–º–µ—Å—Ç–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ - –ø—Ä–æ—Å—Ç–æ–µ —á—Ç–µ–Ω–∏–µ –∏–∑ –ë–î
rentals = get_rentals()  # < 1 –º—Å
```

---

## üíæ SQLite –ë–î

### –î–≤–µ —Ç–∞–±–ª–∏—Ü—ã:

**rentals** - –æ–±—ä—è–≤–ª–µ–Ω–∏—è
```
id | name | price | district | address | rooms | size | description | url | ...
```

**parse_log** - –∏—Å—Ç–æ—Ä–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞
```
id | parsed_at | count | status
```

---

## ‚è±Ô∏è –ì—Ä–∞—Ñ–∏–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

```
00:00 ‚î¨‚îÄ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω
      ‚îÇ
      ‚îú‚îÄ 03:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #1 ‚úì
      ‚îú‚îÄ 06:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #2 ‚úì
      ‚îú‚îÄ 09:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #3 ‚úì
      ‚îú‚îÄ 12:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #4 ‚úì
      ‚îú‚îÄ 15:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #5 ‚úì
      ‚îú‚îÄ 18:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #6 ‚úì
      ‚îî‚îÄ 21:00 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ –ü–∞—Ä—Å–∏–Ω–≥ #7 ‚úì
```

–ò–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ `bot.py`:
```python
scheduler.add_job(
    background_parse_rentals,
    "interval",
    hours=3,  # ‚Üê –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ 1, 2, 6, 24 –∏ —Ç.–¥.
)
```

---

## üéÆ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

```
/start    - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/browse   - –í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (8 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
/search   - –ü–æ–∏—Å–∫ –ø–æ —Ü–µ–Ω–µ/—Ä–∞–π–æ–Ω–∞/—Å–ª–æ–≤—É
/refresh  - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–º–∞–∫—Å 1 —Ä–∞–∑ –≤ 5 –º–∏–Ω)
/favorites - –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
/help     - –°–ø—Ä–∞–≤–∫–∞
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
```python
from rental_data import get_rentals

rentals = get_rentals()  # –ò–∑ –ë–î
for r in rentals:
    print(f"{r['name']} - ‚Ç¨{r['price']}")
```

### –ü–æ–∏—Å–∫ –ø–æ —Ü–µ–Ω–µ
```python
from rental_data import search_rentals

results = search_rentals('price', (300, 800))  # ‚Ç¨300-800
```

### –ü–æ–∏—Å–∫ –ø–æ —Ä–∞–π–æ–Ω—É
```python
results = search_rentals('district', 'Bratislava')
```

### –ü–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤—É
```python
results = search_rentals('keyword', 'balkon')
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ë–î
```python
from database import get_rental_count, get_price_range_db, get_districts_db

print(f"–í—Å–µ–≥–æ: {get_rental_count()} –æ–±—ä—è–≤–ª–µ–Ω–∏–π")
print(f"–¶–µ–Ω–∞: ‚Ç¨{get_price_range_db()[0]}-{get_price_range_db()[1]}")
print(f"–†–∞–π–æ–Ω—ã: {', '.join(get_districts_db())}")
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–∞—Ä—Å–∏–Ω–≥–∞

**–í —Ñ–∞–π–ª–µ: `bot.py` (–æ–∫–æ–ª–æ —Å—Ç—Ä–æ–∫–∏ 600)**

```python
scheduler.add_job(
    background_parse_rentals,
    "interval",
    hours=3,  # ‚Üê –ò–ó–ú–ï–ù–ò–¢–ï –≠–¢–û
)
```

–ü—Ä–∏–º–µ—Ä—ã:
- `hours=1` - –∫–∞–∂–¥—ã–π —á–∞—Å
- `hours=6` - –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
- `hours=24` - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
- `minutes=30` - –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç

### –ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞—Ä—Å–∏–Ω–≥–∞

**–í —Ñ–∞–π–ª–µ: `rental_data.py` (–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `background_parse_rentals`)**

```python
rentals = scrape_bazos(max_pages=15)  # ‚Üê –ò–ó–ú–ï–ù–ò–¢–ï –≠–¢–û
```

- `max_pages=5` - –±—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (50 –æ–±—ä—è–≤–ª–µ–Ω–∏–π)
- `max_pages=20` - –ø–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–±–æ–ª–µ–µ 200)
- `max_pages=50` - –æ—á–µ–Ω—å –ø–æ–ª–Ω—ã–π (500+)

---

## üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

### –ü–µ—Ä–≤—ã–π —Ä–∞–∑
```bash
python3 bot.py
```

–ë—É–¥–µ—Ç:
1. ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ë–î
2. ‚úÖ –ó–∞–ø—É—â–µ–Ω –ø–µ—Ä–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥
3. ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –æ–±—ä—è–≤–ª–µ–Ω–∏—è
4. ‚úÖ –ó–∞–ø—É—â–µ–Ω –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (APScheduler)
5. ‚úÖ –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –õ–æ–≥–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
```
============================================================
ü§ñ BRATISLAVA RENTAL FINDER BOT
============================================================
üìä –î–∞—Ç–∞: reality.bazos.sk
üö´ –§–∏–ª—å—Ç—Ä: —Ä–∏–µ–ª—Ç–æ—Ä—ã –∏ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ –∏—Å–∫–ª—é—á–µ–Ω—ã
üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥: –∫–∞–∂–¥—ã–µ 3 —á–∞—Å–∞
============================================================

INFO: üîÑ Starting scheduled parse...
INFO: Page 1: https://reality.bazos.sk/prenajmu/byt/
INFO:   -> Added 18, total: 18
...
INFO: DONE: 206 rentals
INFO: üìä Saved: 206 new, 0 updated rentals
INFO: ‚úÖ Parse log: 206 rentals, status=success
‚úÖ Scheduler started
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –û–ø–µ—Ä–∞—Ü–∏—è | –°—Ç–∞—Ä–∞—è | –ù–æ–≤–∞—è |
|----------|--------|-------|
| `/browse` (–ø–µ—Ä–≤—ã–π —Ä–∞–∑) | 45 —Å–µ–∫ | 0.5 —Å–µ–∫ |
| `/browse` (–ø–æ–≤—Ç–æ—Ä–Ω–æ) | 45 —Å–µ–∫ | 0.5 —Å–µ–∫ |
| `/search` | 50 —Å–µ–∫ | 0.3 —Å–µ–∫ |
| –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ bazos | –í—ã—Å–æ–∫–∞—è | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è |
| –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —é–∑–µ—Ä? | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |

### –°–∫–æ–ª—å–∫–æ –Ω–∞–≥—Ä—É–∂–∞–µ–º bazos.sk?

```
–°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞:
‚Ä¢ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Üí 10 –ø–∞—Ä—Å–∏–Ω–≥–æ–≤/—á–∞—Å = 10 –∑–∞–ø—Ä–æ—Å–æ–≤

–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:
‚Ä¢ 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Üí 1 –ø–∞—Ä—Å–∏–Ω–≥/3 —á–∞—Å–∞ = 0.33 –∑–∞–ø—Ä–æ—Å–∞/—á–∞—Å
```

**–†–∞–∑–Ω–∏—Ü–∞: 30x –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏!** üéâ

---

## üêõ –ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º

### –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
python3 bot.py
# –°–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª–∏
```

### –ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π
```bash
python3 -c "from database import get_rental_count; print(get_rental_count())"
# –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ > 0
```

### –ü–∞—Ä—Å–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
python3 -c "
import asyncio
from rental_data import background_parse_rentals
asyncio.run(background_parse_rentals())
"
# –î–æ–ª–∂–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è
```

### –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î —Å –Ω—É–ª—è
```bash
rm rentals.db
python3 bot.py  # –°–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—É—é –ë–î –∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç
```

---

## üìö –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ

–°–º. —Ñ–∞–π–ª `ARCHITECTURE.md` –¥–ª—è:
- –ü–æ–ª–Ω–æ–π —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
- –î–∏–∞–≥—Ä–∞–º–º—ã –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- API —Ñ—É–Ω–∫—Ü–∏–π
- SQL –∑–∞–ø—Ä–æ—Å–æ–≤
- –ë—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π

---

**–ì–æ—Ç–æ–≤–æ! üöÄ –í–∞—à –±–æ—Ç —Ç–µ–ø–µ—Ä—å –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–µ–µ!**
